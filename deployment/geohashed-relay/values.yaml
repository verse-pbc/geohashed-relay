replicaCount: 1
image:
  repository: ghcr.io/verse-pbc/geohashed-relay
  tag: "0.1.20250903-1613-f2feb06" # Uses Chart.AppVersion when empty
  pullPolicy: Always
# StatefulSet configuration
statefulset:
  serviceName: geohashed-relay
# Persistent storage for LMDB
persistence:
  enabled: true
  storageClass: "" # Use default storage class
  size: 20Gi
  accessMode: ReadWriteOnce
# Pod Disruption Budget
pdb:
  minAvailable: 1
# Autoscaling (disabled for LMDB single-writer constraint)
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 1
  targetCPUUtilizationPercentage: 80
# Service configuration
service:
  type: ClusterIP
  port: 80
  targetPort: 8080
# Ingress configuration
ingress:
  enabled: true
  className: "nginx"
  host: "geohashed.verse.app"
  tls:
    enabled: true
    secretName: geohashed-relay-tls
# Resource limits and requests
resources:
  requests:
    memory: "512Mi"
    cpu: "250m"
  limits:
    memory: "2Gi"
    cpu: "1000m"
# Environment variables
# Note: RELAY_PRIVATE_KEY is provided via sealed secret (see SECRETS.md)
env:
  RUST_LOG: "info"
  DATABASE_PATH: "/data"
  RELAY_HOST: "0.0.0.0"
  RELAY_PORT: "8080"
  RELAY_URL: "wss://geohashed.verse.app"
  EVENTS_PER_MINUTE: "30"
  REQUIRE_AUTH_FOR_WRITE: "false"
  REQUIRE_AUTH_FOR_READ: "false"
# Health check configuration
healthCheck:
  enabled: true
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  successThreshold: 1
  failureThreshold: 3
# Security context
securityContext:
  runAsNonRoot: true
  runAsUser: 1001
  runAsGroup: 1001
  fsGroup: 1001
